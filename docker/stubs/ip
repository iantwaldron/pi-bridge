#!/usr/bin/env python3
import sys

KNOWN = {
    "eth0": "192.168.1.100/24",
    "wlan0": "192.168.31.4/24",
    "wlan1": "192.168.31.4/24",
    "usb0": None,
}

def show_addr(interface: str) -> int:
    cidr = KNOWN.get(interface)
    if interface not in KNOWN:
        return 1
    print(f"3: {interface}: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500")
    if cidr:
        ip = cidr.split("/", 1)[0]
        prefix = ip.rsplit(".", 1)[0]
        print(f"    inet {cidr} brd {prefix}.255 scope global {interface}")
    return 0


def show_link(interface: str) -> int:
    if interface not in KNOWN:
        return 1
    print(f"3: {interface}: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000")
    print("    link/ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff")
    return 0


def show_link_all() -> int:
    idx = 2
    for interface in ("eth0", "usb0", "wlan0", "wlan1"):
        print(f"{idx}: {interface}: <BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default qlen 1000")
        idx += 1
    return 0


def main() -> int:
    args = sys.argv[1:]
    if len(args) == 4 and args[0] == '-4' and args[1] == 'addr' and args[2] == 'show':
        return show_addr(args[3])
    if len(args) == 3 and args[0] == '-o' and args[1] == 'link' and args[2] == 'show':
        return show_link_all()
    if len(args) == 3 and args[0] == 'link' and args[1] == 'show':
        return show_link(args[2])
    if len(args) == 4 and args[0] == 'link' and args[1] == 'set':
        return 0 if args[2] in KNOWN else 1
    if len(args) == 4 and args[0] == 'addr' and args[1] == 'flush' and args[2] == 'dev':
        return 0 if args[3] in KNOWN else 1
    if len(args) >= 5 and args[0] == 'addr' and args[1] == 'add' and args[3] == 'dev':
        return 0 if args[4] in KNOWN else 1
    return 0


if __name__ == '__main__':
    raise SystemExit(main())
